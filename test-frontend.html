<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Frontend Test - LP Staking</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background: #f5f5f5;
        }
        .test-section {
            background: white;
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .test-button {
            background: #1976d2;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            margin: 5px;
        }
        .test-button:hover {
            background: #1565c0;
        }
        .status {
            padding: 10px;
            margin: 10px 0;
            border-radius: 4px;
        }
        .success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        .error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        .info {
            background: #d1ecf1;
            color: #0c5460;
            border: 1px solid #bee5eb;
        }
    </style>
</head>
<body>
    <h1>LP Staking Frontend Test</h1>
    
    <div class="test-section">
        <h2>System Status</h2>
        <div id="system-status" class="status info">Checking system status...</div>
        <button class="test-button" onclick="checkSystemStatus()">Refresh Status</button>
    </div>

    <div class="test-section">
        <h2>Theme System Test</h2>
        <button class="test-button" onclick="testThemeToggle()">Toggle Theme</button>
        <button class="test-button" onclick="testThemeManager()">Test Theme Manager</button>
        <div id="theme-status" class="status info">Theme system ready</div>
    </div>

    <div class="test-section">
        <h2>Notification System Test</h2>
        <button class="test-button" onclick="testNotifications('success')">Success Notification</button>
        <button class="test-button" onclick="testNotifications('error')">Error Notification</button>
        <button class="test-button" onclick="testNotifications('warning')">Warning Notification</button>
        <button class="test-button" onclick="testNotifications('info')">Info Notification</button>
        <div id="notification-status" class="status info">Notification system ready</div>
    </div>

    <div class="test-section">
        <h2>Modal System Test</h2>
        <button class="test-button" onclick="testStakingModal()">Open Staking Modal</button>
        <div id="modal-status" class="status info">Modal system ready</div>
    </div>

    <div class="test-section">
        <h2>Data Loading Test</h2>
        <button class="test-button" onclick="testDataLoading()">Test Data Loading</button>
        <div id="data-status" class="status info">Data system ready</div>
    </div>

    <div class="test-section">
        <h2>Wallet Connection Test</h2>
        <button class="test-button" onclick="testWalletConnection()">Test Wallet Connection</button>
        <div id="wallet-status" class="status info">Wallet system ready</div>
    </div>

    <div class="test-section">
        <h2>Main Application</h2>
        <button class="test-button" onclick="openMainApp()">Open Main Application</button>
        <div class="status info">Click to open the main LP Staking application</div>
    </div>

    <!-- Load the same scripts as main app -->
    <script src="https://unpkg.com/ethers@5.7.2/dist/ethers.umd.min.js"></script>
    <script src="js/master-initializer.js"></script>

    <script>
        // Test functions
        function checkSystemStatus() {
            const statusDiv = document.getElementById('system-status');
            
            const checks = [
                { name: 'Master Initializer', check: () => window.masterInitializer },
                { name: 'Theme Manager', check: () => window.themeManager },
                { name: 'Notification Manager', check: () => window.notificationManager },
                { name: 'Wallet Manager', check: () => window.walletManager },
                { name: 'Home Page', check: () => window.homePage },
                { name: 'Staking Modal', check: () => window.stakingModal }
            ];

            let allPassed = true;
            let results = [];

            checks.forEach(({ name, check }) => {
                const passed = check();
                results.push(`${name}: ${passed ? '✅' : '❌'}`);
                if (!passed) allPassed = false;
            });

            statusDiv.className = `status ${allPassed ? 'success' : 'error'}`;
            statusDiv.innerHTML = `
                <strong>System Status: ${allPassed ? 'All Systems Operational' : 'Some Systems Failed'}</strong><br>
                ${results.join('<br>')}
            `;
        }

        function testThemeToggle() {
            if (window.themeManager) {
                window.themeManager.toggleTheme();
                document.getElementById('theme-status').innerHTML = 
                    `Theme toggled to: ${window.themeManager.getCurrentTheme()}`;
            } else {
                document.getElementById('theme-status').className = 'status error';
                document.getElementById('theme-status').innerHTML = 'Theme manager not available';
            }
        }

        function testThemeManager() {
            const statusDiv = document.getElementById('theme-status');
            if (window.themeManager) {
                const currentTheme = window.themeManager.getCurrentTheme();
                statusDiv.className = 'status success';
                statusDiv.innerHTML = `Theme Manager Working! Current theme: ${currentTheme}`;
            } else {
                statusDiv.className = 'status error';
                statusDiv.innerHTML = 'Theme Manager not found!';
            }
        }

        function testNotifications(type) {
            if (window.notificationManager) {
                const messages = {
                    success: 'This is a success notification!',
                    error: 'This is an error notification!',
                    warning: 'This is a warning notification!',
                    info: 'This is an info notification!'
                };
                
                window.notificationManager.show(messages[type], type);
                document.getElementById('notification-status').className = 'status success';
                document.getElementById('notification-status').innerHTML = `${type} notification sent!`;
            } else {
                document.getElementById('notification-status').className = 'status error';
                document.getElementById('notification-status').innerHTML = 'Notification manager not available';
            }
        }

        function testStakingModal() {
            if (window.stakingModal) {
                const mockPair = {
                    id: '1',
                    token0Symbol: 'LIB',
                    token1Symbol: 'USDC',
                    name: 'LIB/USDC LP',
                    platform: 'Uniswap V2',
                    apr: '125.50'
                };
                
                window.stakingModal.open(mockPair, 'stake');
                document.getElementById('modal-status').className = 'status success';
                document.getElementById('modal-status').innerHTML = 'Staking modal opened successfully!';
            } else {
                document.getElementById('modal-status').className = 'status error';
                document.getElementById('modal-status').innerHTML = 'Staking modal not available';
            }
        }

        function testDataLoading() {
            if (window.homePage) {
                window.homePage.loadData();
                document.getElementById('data-status').className = 'status success';
                document.getElementById('data-status').innerHTML = 'Data loading initiated!';
            } else {
                document.getElementById('data-status').className = 'status error';
                document.getElementById('data-status').innerHTML = 'Home page component not available';
            }
        }

        function testWalletConnection() {
            if (window.walletManager) {
                const isConnected = window.walletManager.isWalletConnected();
                const account = window.walletManager.getAccount();
                
                document.getElementById('wallet-status').className = 'status info';
                document.getElementById('wallet-status').innerHTML = 
                    `Wallet Status: ${isConnected ? 'Connected' : 'Not Connected'}<br>
                     Account: ${account || 'None'}`;
            } else {
                document.getElementById('wallet-status').className = 'status error';
                document.getElementById('wallet-status').innerHTML = 'Wallet manager not available';
            }
        }

        function openMainApp() {
            window.open('index.html', '_blank');
        }

        // Auto-check status when page loads
        document.addEventListener('DOMContentLoaded', () => {
            setTimeout(checkSystemStatus, 2000);
        });

        // Listen for system ready event
        document.addEventListener('systemReady', () => {
            checkSystemStatus();
        });
    </script>
</body>
</html>
